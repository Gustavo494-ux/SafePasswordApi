version: '3'


services:
  SafePassword_Mysql:
    image: mysql:8
    container_name: SafePassword_Mysql
    hostname: SafePassword_Mysql
    restart: always
    env_file:
      - .env
    environment:
      MYSQL_ROOT_PASSWORD: ${DB_PASSWORD}
      MYSQL_DATABASE: ${DB_NAME}
    ports:
      - "${DB_PORT}:3306"
    volumes:
      - /e/Projetos/go/src/SafePasswordApi/Mysql:/var/lib/mysql                                                                                                                                                                                                                   

  safepassword:
    build: ./
    container_name: safepassword
    # volumes:
    #   - .:/go/src
    restart: always
    ports:
      - ${API_PORT}:${API_PORT}
    depends_on:
      - SafePassword_Mysql
  
  dev:
    build: 
      context: ./
      dockerfile : Dockerfile.dev
    container_name: dev
    working_dir: /go/src
    volumes:
      - ./:/go/src
    restart: always
    ports:
      - ${API_PORT}:${API_PORT}
    depends_on:
      - SafePassword_Mysql


# docker volume create --driver local --opt type=none --opt device=/e/Projetos/go/src/SafePasswordApi/Mysql --opt o=bind vol_mysql_safepassword